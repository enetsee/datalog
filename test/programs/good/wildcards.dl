rule link(?line: @Int, ?station: @Symbol, ?next:@Symbol)
rule station_connected(?station:@Symbol, ?next: @Symbol)
rule line_connected(?line: @Int, ?station:@Symbol)

station_connected(?s,?s) :- link(_,?s,_) ; link(_,_,?s).
station_connected(?s,?t) :- station_connected(?s,?u) , link(_,?u,?t).

line_connected(?l,?s) :- station_connected(?s,?t) , link(?l,?t,_).